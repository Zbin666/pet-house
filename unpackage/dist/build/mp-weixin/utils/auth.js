"use strict";const e=require("../common/vendor.js");exports.checkLogin=()=>{const n=e.index.getStorageSync("token");return{isLoggedIn:!!n,token:n,userInfo:e.index.getStorageSync("userInfo")}},exports.isTokenValid=e=>{if(!e||"string"!=typeof e)return!1;const n=e.split(".");if(3!==n.length)return!1;try{const e=JSON.parse(decodeURIComponent(escape(atob(n[1]))));if(!e||!e.exp)return!1;const r=Math.floor(Date.now()/1e3);return e.exp>r+60}catch(r){return!1}},exports.logout=()=>{const n=e.index.getStorageSync("userInfo"),r=n?{nickname:n.nickname,avatarUrl:n.avatarUrl}:null;e.index.removeStorageSync("token"),e.index.removeStorageSync("userInfo"),e.index.removeStorageSync("agreed"),r&&r.nickname&&r.avatarUrl&&e.index.setStorageSync("basicUserInfo",r),e.index.reLaunch({url:"/pages/login/login"})};
