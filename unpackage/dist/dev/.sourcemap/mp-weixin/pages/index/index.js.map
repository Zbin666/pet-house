{"version":3,"file":"index.js","sources":["pages/index/index.vue","../../HBuilderX.4.57/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\n\t<view class=\"home-page\">\n\t\t<!-- Header -->\n\t\t<view class=\"header\">\n\t\t\t<view class=\"greet\">\n\t\t\t\t<text class=\"hi\">Hi {{ userInfo?.nickname || '用户' }}</text>\n\t\t\t\t<text class=\"sub\">{{ getGreeting() }}</text>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- Pet card -->\n\t\t<view class=\"pet-card\">\n\t\t\t<view class=\"pet-top-decoration\">\n\t\t\t\t<image class=\"decoration-img\" src=\"/static/index/longCircle.svg\" mode=\"widthFix\" />\n\t\t\t</view>\n\t\t\t<view v-if=\"hasPet\" class=\"pet-content\" @tap=\"goPetDetail\">\n\t\t\t\t<view class=\"pet-left\">\n\t\t\t\t\t<view class=\"pet-avatar\">\n\t\t\t\t\t\t<image v-if=\"currentPet?.avatarUrl\" :src=\"currentPet.avatarUrl\" class=\"pet-avatar-inner\" mode=\"aspectFill\" />\n\t\t\t\t\t\t<view v-else class=\"pet-avatar-inner\"></view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"pet-right\">\n\t\t\t\t\t<view class=\"pet-title-row\">\n\t\t\t\t\t\t<text class=\"pet-name\">{{ currentPet?.name || '我的宠物' }}</text>\n\t\t\t\t\t\t<text class=\"pet-edit\">✎</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"pet-meta\">{{ petMeta }}</text>\n\t\t\t\t\t<view class=\"pet-tags\" v-if=\"petTags.length\">\n\t\t\t\t\t\t<text v-for=\"(tag, i) in petTags\" :key=\"i\" class=\"tag\">{{ tag }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view v-else class=\"pet-empty\" @tap=\"goAddPet\">\n\t\t\t\t<image class=\"add-icon\" src=\"/static/index/add.png\" mode=\"widthFix\" />\n\t\t\t\t<text class=\"add-text\">添加我的宠物</text>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- Quick list + small cards -->\n\t\t<view class=\"row\">\n\t\t\t<view class=\"todo-card\">\n\t\t\t\t<view class=\"todo-item\">\n\t\t\t\t\t<view class=\"bullet\"></view><text>给火火打疫苗</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"todo-item\">\n\t\t\t\t\t<view class=\"bullet\"></view><text>清理猫砂</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"todo-item\">\n\t\t\t\t\t<view class=\"bullet\"></view><text>购买火火吃的小零食</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"todo-item\">\n\t\t\t\t\t<view class=\"bullet\"></view><text>给火火清理耳朵</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"todo-item\">\n\t\t\t\t\t<view class=\"bullet\"></view><text>给火火剪指甲</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view class=\"side-cards\">\n\t\t\t\t<view class=\"side-card\" @tap=\"goToRecord('calendar')\">\n\t\t\t\t\t<view class=\"side-texts\">\n\t\t\t\t\t\t<text class=\"side-title\">记录</text>\n\t\t\t\t\t\t<text class=\"side-sub\">更好的照顾小宠</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<image class=\"side-icon\" src=\"/static/index/record.png\" mode=\"widthFix\" />\n\t\t\t\t</view>\n\t\t\t\t<view class=\"side-card\" @tap=\"goToRecord('stats')\">\n\t\t\t\t\t<view class=\"side-texts\">\n\t\t\t\t\t\t<text class=\"side-title\">提醒</text>\n\t\t\t\t\t\t<text class=\"side-sub\">防止忘记</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<image class=\"side-icon\" src=\"/static/index/note.png\" mode=\"widthFix\" />\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- Popular science -->\n\t\t<view class=\"science\">\n\t\t\t<view class=\"science-hd\">\n\t\t\t\t<view class=\"science-title\">\n\t\t\t\t\t<text>今日科普</text>\n\t\t\t\t\t<view class=\"title-notch\"></view>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"science-sub\">【长出蒜瓣毛】</text>\n\t\t\t</view>\n\t\t\t<view class=\"science-text\">当你看到自家猫的毛发分层了，那是它的蒜瓣毛—猫咪体表新陈代谢时产生的产物。毛发蓬松，说明平时吃的很好很有营养，是被养的很好的表现哦～</view>\n\t\t\t<image class=\"science-illust\" src=\"/static/index/popular-science.png\" mode=\"widthFix\" />\n\t\t\t<view class=\"science-icons\">\n\t\t\t\t<image class=\"fish\" src=\"/static/index/fish.png\" mode=\"widthFix\" />\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { onShow } from '@dcloudio/uni-app'\nimport { initState, getState } from '@/utils/store.js'\nimport { api } from '@/utils/api.js'\n\ndefineOptions({ name: 'HomeIndex' })\n\nconst hasPet = ref(false)\nconst userInfo = ref(null)\nconst pets = ref([])\nconst currentPet = computed(() => pets.value?.[0] || null)\nconst petMeta = computed(() => {\n  if (!currentPet.value) return ''\n  const months = currentPet.value.months ? `${currentPet.value.months}个月` : ''\n  const weight = currentPet.value.weight ? `${currentPet.value.weight}kg` : ''\n  return [months, weight].filter(Boolean).join(' | ')\n})\nconst petTags = computed(() => {\n  if (!currentPet.value) return []\n  const temperament = currentPet.value.temperament || ''\n  // temperament 可能是以逗号分隔的字符串，或一个简单字符串\n  if (!temperament) return []\n  if (Array.isArray(temperament)) return temperament\n  return String(temperament).split(/[，,\\s]+/).filter(Boolean).slice(0, 3)\n})\n\n// 初始化页面\nonMounted(async () => {\n  // 初始化状态\n  const state = initState()\n  userInfo.value = state.userInfo\n  \n  // 检查登录状态\n  if (!state.isLoggedIn) {\n    uni.reLaunch({\n      url: '/pages/login/login'\n    })\n    return\n  }\n  \n  // 加载宠物数据\n  await loadPets()\n})\n\n// 返回到首页时自动刷新宠物数据\nonShow(async () => {\n  // 如果从详情返回且收到全局事件，或直接返回页面，都刷新一次\n  await loadPets()\n})\n\n// 加载宠物数据\nasync function loadPets() {\n  try {\n    const result = await api.getPets()\n    // 兼容后端直接返回数组 或 包在 data 里\n    pets.value = Array.isArray(result) ? result : (result.data || [])\n    hasPet.value = pets.value.length > 0\n  } catch (error) {\n    console.error('加载宠物数据失败:', error)\n  }\n}\n\n// 获取问候语\nfunction getGreeting() {\n  const hour = new Date().getHours()\n  if (hour < 12) {\n    return 'Good Morning!'\n  } else if (hour < 18) {\n    return 'Good Afternoon!'\n  } else {\n    return 'Good Evening!'\n  }\n}\n\nfunction goAddPet() {\n\tuni.navigateTo({ url: '/pages/createPet/createPet' })\n}\n\nfunction goToRecord(tab) {\n\t// 将 tab 参数存储到全局状态\n\tuni.setStorageSync('recordTab', tab)\n\t// 跳转到 tabBar 页面\n\tuni.switchTab({ url: '/pages/record/record' })\n}\n\nfunction goPetDetail() {\n  const pet = currentPet.value\n  if (!pet || !pet.id) return\n  const q = encodeURIComponent(JSON.stringify(pet))\n  uni.navigateTo({ url: `/pages/petDetail/petDetail?pet=${q}` })\n}\n</script>\n\n<style>\n.home-page {\n\tpadding: 24rpx;\n\tpadding-top: calc(80rpx + env(safe-area-inset-top));\n\t/* iOS 兼容 */\n\tpadding-top: calc(80rpx + constant(safe-area-inset-top));\n\tbackground: linear-gradient(180deg, #fff1a8 0%, #fff3c9 32%, #fff7e3 68%, #fffaf1 100%);\n\tmin-height: 100vh;\n\tbox-sizing: border-box;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n}\n\n/* Header */\n.header {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tmargin-bottom: 24rpx;\n\twidth: 100%;\n\tmax-width: 704rpx;\n}\n\n.greet .hi {\n\tdisplay: block;\n\tfont-size: 36rpx;\n\tfont-weight: 700;\n\tcolor: #1a1a1a;\n}\n\n.greet .sub {\n\tdisplay: block;\n\tmargin-top: 8rpx;\n\tcolor: #6b6b6b;\n\tfont-size: 24rpx;\n}\n\n/* Pet card */\n.pet-card {\n\twidth: 100%;\n\tmax-width: 704rpx;\n\theight: 320rpx;\n\tdisplay: flex;\n\tflex-direction: column;\n\tbackground: #ffffff;\n\tborder-radius: 32rpx;\n\tpadding: 20rpx;\n\tbox-shadow: 0 8rpx 16rpx rgba(0, 0, 0, 0.06);\n\tmargin-bottom: 32rpx;\n\tposition: relative;\n\tborder: 4rpx solid #2c2c2c;\n\tbox-sizing: border-box;\n}\n\n.pet-empty {\n\theight: 100%;\n\twidth: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tgap: 12rpx;\n\tbackground: url('/static/index/add-bg.png') center/cover no-repeat;\n\tborder-radius: 24rpx;\n}\n\n.add-icon {\n\twidth: 100rpx;\n\theight: 100rpx;\n}\n\n.add-text {\n\tfont-size: 36rpx;\n\tfont-weight: 700;\n\tcolor: #1a1a1a;\n}\n\n.pet-top-decoration {\n\tposition: relative;\n\ttop: 3rpx;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\tdisplay: flex;\n\tjustify-content: center;\n\tz-index: 0;\n\tpointer-events: none;\n}\n\n.decoration-oval {\n\twidth: 120rpx;\n\theight: 20rpx;\n\tbackground: linear-gradient(90deg, #ffeb3b 0%, #fff9c4 100%);\n\tborder-radius: 40%;\n\tborder: 2rpx solid #2c2c2c;\n}\n\n.decoration-img {\n\twidth: 160rpx;\n\theight: 24rpx;\n\tdisplay: block;\n\tborder-radius: 40rpx;\n}\n\n/* svg not supported on mp-weixin; use CSS capsule instead */\n\n.pet-content {\n\tdisplay: flex;\n\tpadding-top: 28rpx;\n}\n\n.pet-left {\n\tmargin-right: 16rpx;\n}\n\n.pet-avatar {\n\twidth: 220rpx;\n\theight: 180rpx;\n\tborder-radius: 20rpx;\n\tbackground: #fff7d6;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder: 4rpx solid #2c2c2c;\n}\n\n.pet-avatar-inner {\n\twidth: 160rpx;\n\theight: 120rpx;\n\tbackground: linear-gradient(180deg, #ffd280, #ffeab1);\n\tborder-radius: 12rpx;\n}\n\n.pet-right {\n\tflex: 1;\n}\n\n.pet-title-row {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n\n.pet-name {\n\tfont-size: 32rpx;\n\tfont-weight: 700;\n\tcolor: #1a1a1a;\n}\n\n.pet-edit {\n\tcolor: #888;\n\tfont-size: 28rpx;\n}\n\n.pet-meta {\n\tdisplay: block;\n\tmargin-top: 8rpx;\n\tcolor: #6b6b6b;\n}\n\n.pet-tags {\n\tdisplay: flex;\n\tgap: 12rpx;\n\tmargin-top: 16rpx;\n}\n\n.tag {\n\tpadding: 6rpx 16rpx;\n\tborder-radius: 999rpx;\n\tfont-size: 22rpx;\n\tborder: 2rpx solid #2c2c2c;\n\tcolor: #1a1a1a;\n\tbackground: #ffe082;\n}\n\n.tag-cute {\n\tbackground: #ffecb3;\n}\n\n.tag-stick {\n\tbackground: #fff2cc;\n}\n\n/* Row */\n.row {\n\tdisplay: flex;\n\tflex-direction: row;\n\tgap: 24rpx;\n\tmargin-bottom: 24rpx;\n\twidth: 100%;\n\tmax-width: 704rpx;\n\tjustify-content: space-between;\n\talign-items: stretch;\n\theight: 358rpx;\n}\n\n.todo-card {\n\twidth: 284rpx;\n\theight: 100%;\n\tbackground: #ffffff;\n\tborder-radius: 32rpx;\n\tpadding: 20rpx;\n\tbox-shadow: 0 8rpx 16rpx rgba(0, 0, 0, 0.06);\n\tborder: 4rpx solid #2c2c2c;\n\tbox-sizing: border-box;\n\tflex-shrink: 0;\n\torder: 1;\n}\n\n.todo-item {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 12rpx;\n\tpadding: 12rpx 0;\n\tfont-size: 26rpx;\n\tcolor: #1a1a1a;\n}\n\n.bullet {\n\twidth: 16rpx;\n\theight: 16rpx;\n\tbackground: #2c2c2c;\n\tborder-radius: 50%;\n}\n\n.side-cards {\n\twidth: 340rpx;\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 20rpx;\n\tflex-shrink: 0;\n\torder: 2;\n}\n\n.side-card {\n\tbackground: #ffffff;\n\tborder-radius: 40rpx;\n\tpadding: 24rpx;\n\tbox-shadow: 0 8rpx 16rpx rgba(0, 0, 0, 0.06);\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 20rpx;\n\tborder: 4rpx solid #2c2c2c;\n\tjustify-content: space-between;\n\theight: 115rpx;\n\t/* 统一两个卡片高度 */\n}\n\n.side-icon {\n\twidth: 86rpx;\n\theight: 86rpx;\n}\n\n.side-texts {\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex: 1;\n\t/* 文本区自适应填充，保证两卡片同高 */\n\tmin-width: 0;\n}\n\n.side-title {\n\tfont-size: 30rpx;\n\tfont-weight: 600;\n\tcolor: #1a1a1a;\n}\n\n.side-sub {\n\tcolor: #6b6b6b;\n\tmargin-top: 8rpx;\n\tfont-size: 22rpx;\n}\n\n/* Science */\n.science {\n    width: 704rpx;\n\theight: 416rpx;\n\tbackground: #ffffff;\n\tborder-radius: 24rpx;\n\tpadding: 26rpx 20rpx 12rpx;\n\t/* 减小上边距与整体竖向间隙 */\n\tbox-shadow: 0 8rpx 16rpx rgba(0, 0, 0, 0.06);\n\tmargin-bottom: 40rpx;\n\t/* 更贴近顶部内容 */\n\tposition: relative;\n\toverflow: hidden;\n\tborder: 4rpx solid #2c2c2c;\n\tbox-sizing: border-box;\n}\n\n.science-hd {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 12rpx;\n\tmargin-bottom: 8rpx;\n\t/* 收紧标题与正文的距离 */\n}\n\n.science-title {\n\tposition: relative;\n\tdisplay: inline-flex;\n\talign-items: center;\n\tbackground: #ffeb3b;\n\tpadding: 10rpx 24rpx 10rpx 28rpx;\n\tborder-radius: 16rpx;\n\tborder: 4rpx solid #2c2c2c;\n}\n\n.science-title text {\n\tfont-weight: 700;\n\tcolor: #1a1a1a;\n}\n\n.title-notch {\n\tposition: absolute;\n\tleft: 12rpx;\n\ttop: -10rpx;\n\twidth: 40rpx;\n\theight: 12rpx;\n\tbackground: #2c2c2c;\n\tborder-radius: 999rpx;\n}\n\n.science-sub {\n\tcolor: #1a1a1a;\n\tmargin-left: 8rpx;\n\tfont-weight: 700;\n}\n\n.science-text {\n\tfont-size: 24rpx;\n\tfont-weight: normal;\n\tdisplay: block;\n\tcolor: #000000;\n\tline-height: 1.8;\n\tmargin: 12rpx 0 16rpx;\n\twidth: 60%;\n\t/* 文本占左侧60%宽度 */\n}\n\n.science-illust {\n\tposition: absolute;\n\tright: 5rpx;\n\tbottom: 10rpx;\n\twidth: 280rpx;\n}\n\n.science-icons {\n\tposition: absolute;\n\tleft: 16rpx;\n\tbottom: 10rpx;\n\tdisplay: flex;\n\tgap: 12rpx;\n\talign-items: center;\n}\n\n.fish {\n\twidth: 165rpx;\n\theight: 24rpx;\n}\n\n/* 真机调试适配 */\n@media screen and (max-width: 750px) {\n\t.home-page {\n\t\tpadding-top: calc(110rpx + 20px);\n\t}\n}\n\n/* 小屏幕设备适配 */\n@media screen and (max-width: 600px) {\n\t.home-page {\n\t\tpadding-left: 12rpx;\n\t\tpadding-right: 12rpx;\n\t}\n\t\n\t.pet-card,\n\t.science {\n\t\twidth: calc(100vw - 24rpx);\n\t\tmax-width: 704rpx;\n\t}\n\t\n\t.row {\n\t\tflex-direction: row;\n\t\tgap: 12rpx;\n\t\twidth: 100%;\n\t}\n\t\n\t.todo-card {\n\t\twidth: 50%;\n\t\tmax-width: 320rpx;\n\t}\n\t\n\t.side-cards {\n\t\twidth: 50%;\n\t\tmax-width: 384rpx;\n\t}\n}\n</style>\n","import MiniProgramPage from 'E:/Uni-App-file/pet-house/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","onMounted","initState","uni","onShow","api","MiniProgramPage"],"mappings":";;;;;;;;AAsGA,UAAM,SAASA,cAAG,IAAC,KAAK;AACxB,UAAM,WAAWA,cAAG,IAAC,IAAI;AACzB,UAAM,OAAOA,cAAG,IAAC,EAAE;AACnB,UAAM,aAAaC,cAAQ,SAAC,MAAM;;AAAA,yBAAK,UAAL,mBAAa,OAAM;AAAA,KAAI;AACzD,UAAM,UAAUA,cAAQ,SAAC,MAAM;AAC7B,UAAI,CAAC,WAAW;AAAO,eAAO;AAC9B,YAAM,SAAS,WAAW,MAAM,SAAS,GAAG,WAAW,MAAM,MAAM,OAAO;AAC1E,YAAM,SAAS,WAAW,MAAM,SAAS,GAAG,WAAW,MAAM,MAAM,OAAO;AAC1E,aAAO,CAAC,QAAQ,MAAM,EAAE,OAAO,OAAO,EAAE,KAAK,KAAK;AAAA,IACpD,CAAC;AACD,UAAM,UAAUA,cAAQ,SAAC,MAAM;AAC7B,UAAI,CAAC,WAAW;AAAO,eAAO,CAAE;AAChC,YAAM,cAAc,WAAW,MAAM,eAAe;AAEpD,UAAI,CAAC;AAAa,eAAO,CAAE;AAC3B,UAAI,MAAM,QAAQ,WAAW;AAAG,eAAO;AACvC,aAAO,OAAO,WAAW,EAAE,MAAM,SAAS,EAAE,OAAO,OAAO,EAAE,MAAM,GAAG,CAAC;AAAA,IACxE,CAAC;AAGDC,kBAAAA,UAAU,YAAY;AAEpB,YAAM,QAAQC,YAAAA,UAAW;AACzB,eAAS,QAAQ,MAAM;AAGvB,UAAI,CAAC,MAAM,YAAY;AACrBC,sBAAAA,MAAI,SAAS;AAAA,UACX,KAAK;AAAA,QACX,CAAK;AACD;AAAA,MACD;AAGD,YAAM,SAAU;AAAA,IAClB,CAAC;AAGDC,kBAAAA,OAAO,YAAY;AAEjB,YAAM,SAAU;AAAA,IAClB,CAAC;AAGD,mBAAe,WAAW;AACxB,UAAI;AACF,cAAM,SAAS,MAAMC,UAAG,IAAC,QAAS;AAElC,aAAK,QAAQ,MAAM,QAAQ,MAAM,IAAI,SAAU,OAAO,QAAQ;AAC9D,eAAO,QAAQ,KAAK,MAAM,SAAS;AAAA,MACpC,SAAQ,OAAO;AACdF,sBAAAA,MAAA,MAAA,SAAA,gCAAc,aAAa,KAAK;AAAA,MACjC;AAAA,IACH;AAGA,aAAS,cAAc;AACrB,YAAM,QAAO,oBAAI,KAAM,GAAC,SAAU;AAClC,UAAI,OAAO,IAAI;AACb,eAAO;AAAA,MACX,WAAa,OAAO,IAAI;AACpB,eAAO;AAAA,MACX,OAAS;AACL,eAAO;AAAA,MACR;AAAA,IACH;AAEA,aAAS,WAAW;AACnBA,oBAAAA,MAAI,WAAW,EAAE,KAAK,6BAA4B,CAAE;AAAA,IACrD;AAEA,aAAS,WAAW,KAAK;AAExBA,0BAAI,eAAe,aAAa,GAAG;AAEnCA,oBAAAA,MAAI,UAAU,EAAE,KAAK,uBAAsB,CAAE;AAAA,IAC9C;AAEA,aAAS,cAAc;AACrB,YAAM,MAAM,WAAW;AACvB,UAAI,CAAC,OAAO,CAAC,IAAI;AAAI;AACrB,YAAM,IAAI,mBAAmB,KAAK,UAAU,GAAG,CAAC;AAChDA,oBAAG,MAAC,WAAW,EAAE,KAAK,kCAAkC,CAAC,IAAI;AAAA,IAC/D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxLA,GAAG,WAAWG,SAAe;"}