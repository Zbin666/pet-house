{"version":3,"file":"scienceDetail.js","sources":["pages/scienceDetail/scienceDetail.vue","../../HBuilderX.4.57/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2NpZW5jZURldGFpbC9zY2llbmNlRGV0YWlsLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"page\" :style=\"dynamicTopPadding\">\n\t\t<!-- ç§‘æ™®å†…å®¹å¡ç‰‡ -->\n\t\t<view class=\"content-card\">\n\t\t\t<!-- æ ‡é¢˜åŒºåŸŸ -->\n\t\t\t<view class=\"title-section\">\n\t\t\t\t<view class=\"title-tag\">\n\t\t\t\t\t<text class=\"title-text\">{{ article.title }}</text>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"read-count\">{{ article.reads }}ä¸ªé˜…è¯»</text>\n\t\t\t</view>\n\n\t\t\t<!-- å¯Œæ–‡æœ¬å†…å®¹ -->\n\t\t\t<view class=\"rich-content\">\n\t\t\t\t<rich-text v-if=\"isRichContent(article.content)\" :nodes=\"article.content\" />\n\t\t\t\t<text v-else>{{ article.content }}</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- å›¾ç‰‡ç½‘æ ¼ï¼ˆå¦‚æœæœ‰ï¼‰ -->\n\t\t\t<view class=\"image-grid\" v-if=\"article.images && article.images.length\">\n\t\t\t\t<image \n\t\t\t\t\tclass=\"content-image\" \n\t\t\t\t\tv-for=\"(img, index) in article.images\" \n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:src=\"img\" \n\t\t\t\t\tmode=\"aspectFill\" \n\t\t\t\t\t@tap=\"previewImage(img, article.images)\"\n\t\t\t\t/>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script setup lang=\"ts\">\nimport { reactive, ref, onMounted } from 'vue'\nimport { onLoad } from '@dcloudio/uni-app'\nimport { api } from '@/utils/api.js'\n\n// åŠ¨æ€é¡¶éƒ¨å†…è¾¹è·\nconst dynamicTopPadding = ref('')\nonMounted(() => {\n\ttry {\n\t\tconst info = uni.getSystemInfoSync()\n\t\tconst statusBar = info.statusBarHeight || 0\n\t\tconst screenW = info.screenWidth || 375\n\t\tconst rpxToPx = (rpx) => (rpx * screenW) / 750\n\t\tconst topPx = 15\n\t\tdynamicTopPadding.value = `padding-top:${topPx}px;`\n\t} catch (e) {\n\t\tdynamicTopPadding.value = ''\n\t}\n})\n\ntype Article = {\n\tid: string\n\ttitle: string\n\treads: number\n\tcontent: string\n\timages?: string[]\n\tauthor?: {\n\t\tname: string\n\t\tavatar: string\n\t}\n\tcreatedAt?: string\n\tupdatedAt?: string\n}\n\nconst article = reactive<Article>({\n\tid: '',\n\ttitle: 'åŠ è½½ä¸­...',\n\treads: 0,\n\tcontent: 'æ­£åœ¨åŠ è½½æ–‡ç« å†…å®¹...',\n\timages: [],\n\tauthor: {\n\t\tname: 'ç§‘æ™®å®˜',\n\t\tavatar: '/static/logo.png'\n\t},\n\tcreatedAt: '',\n\tupdatedAt: ''\n})\n\n// åˆ¤æ–­æ˜¯å¦ä¸ºå¯Œæ–‡æœ¬å†…å®¹\nfunction isRichContent(content: string): boolean {\n\tif (!content || typeof content !== 'string') return false\n\t// æ£€æŸ¥æ˜¯å¦åŒ…å«HTMLæ ‡ç­¾\n\treturn /<[^>]+>/.test(content)\n}\n\n// åŠ è½½æ–‡ç« è¯¦æƒ…\nasync function loadArticleDetail(articleId: string) {\n\ttry {\n\t\tuni.__f__('log','at pages/scienceDetail/scienceDetail.vue:92','ğŸ” å¼€å§‹åŠ è½½æ–‡ç« è¯¦æƒ…ï¼ŒID:', articleId)\n\t\tconst res = await api.getArticle(articleId)\n\t\tuni.__f__('log','at pages/scienceDetail/scienceDetail.vue:94','ğŸ“¡ æ–‡ç« è¯¦æƒ…APIè¿”å›:', res)\n\t\t\n\t\t// å¤„ç†contentä¸ºnullçš„æƒ…å†µ\n\t\tlet content = res.content\n\t\tif (!content || content === null) {\n\t\t\tcontent = res.title || 'æš‚æ— å†…å®¹'\n\t\t\tuni.__f__('log','at pages/scienceDetail/scienceDetail.vue:100','âš ï¸ æ–‡ç« contentä¸ºnullï¼Œä½¿ç”¨titleä½œä¸ºå†…å®¹:', content)\n\t\t}\n\t\t\n\t\t// æ›´æ–°æ–‡ç« æ•°æ®\n\t\tObject.assign(article, {\n\t\t\tid: res.id || articleId,\n\t\t\ttitle: res.title || 'æ— æ ‡é¢˜',\n\t\t\treads: res.reads || 0,\n\t\t\tcontent: content,\n\t\t\tcover: res.cover || '/static/logo.png',\n\t\t\timages: res.images || [],\n\t\t\tauthor: {\n\t\t\t\tname: res.author?.name || 'ç§‘æ™®å®˜',\n\t\t\t\tavatar: res.author?.avatar || '/static/logo.png'\n\t\t\t},\n\t\t\tcreatedAt: res.createdAt || '',\n\t\t\tupdatedAt: res.updatedAt || ''\n\t\t})\n\t\t\n\t\tuni.__f__('log','at pages/scienceDetail/scienceDetail.vue:119','âœ… æ–‡ç« è¯¦æƒ…åŠ è½½å®Œæˆ:', article)\n\t} catch (error) {\n\t\tuni.__f__('error','at pages/scienceDetail/scienceDetail.vue:121','âŒ åŠ è½½æ–‡ç« è¯¦æƒ…å¤±è´¥:', error)\n\t\tuni.showToast({\n\t\t\ttitle: 'åŠ è½½å¤±è´¥',\n\t\t\ticon: 'none'\n\t\t})\n\t}\n}\n\n// å›¾ç‰‡é¢„è§ˆåŠŸèƒ½\nfunction previewImage(current: string, urls: string[]) {\n\tuni.previewImage({\n\t\tcurrent,\n\t\turls\n\t})\n}\n\n// è®¾ç½®é¡¶éƒ¨å¯¼èˆªæ ‡é¢˜ä¸èƒŒæ™¯è‰²\nonLoad((options) => {\n\ttry {\n\t\tuni.setNavigationBarTitle({ title: 'ç§‘æ™®è¯¦æƒ…' })\n\t\tuni.setNavigationBarColor({ frontColor: '#000000', backgroundColor: '#fff1a8' })\n\t\t\n\t\t// ä»URLå‚æ•°è·å–æ–‡ç« ID\n\t\tif (options.id) {\n\t\t\tloadArticleDetail(options.id)\n\t\t} else {\n\t\t\t// å°è¯•ä»äº‹ä»¶é€šé“è·å–æ–‡ç« æ•°æ®\n\t\t\ttry {\n\t\t\t\tconst ec = getCurrentPages().pop()?.getOpenerEventChannel?.()\n\t\t\t\tec && ec.on('science', (data: Partial<Article>) => {\n\t\t\t\t\tObject.assign(article, data)\n\t\t\t\t\t// å¦‚æœæœ‰IDï¼Œé‡æ–°åŠ è½½è¯¦æƒ…\n\t\t\t\t\tif (data.id) {\n\t\t\t\t\t\tloadArticleDetail(data.id)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} catch (e) {\n\t\t\t\tuni.__f__('error','at pages/scienceDetail/scienceDetail.vue:158','è·å–æ–‡ç« æ•°æ®å¤±è´¥:', e)\n\t\t\t}\n\t\t}\n\t} catch (e) {\n\t\tuni.__f__('error','at pages/scienceDetail/scienceDetail.vue:162','é¡µé¢åŠ è½½å¤±è´¥:', e)\n\t}\n})\n</script>\n\n<style scoped>\n.page { \n\tpadding: 24rpx 60rpx; \n\t/* åŠ¨æ€è®¡ç®—é¡¶éƒ¨é—´è·ï¼Œé¿å…çœŸæœºè°ƒè¯•æ—¶envä¸ç”Ÿæ•ˆ */\n\tmin-height: 100vh; \n\tbackground: linear-gradient(180deg, #fff1a8 0%, #fff3c9 32%, #fff7e3 68%, #fffaf1 100%); \n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tbox-sizing: border-box;\n}\n\n/* æ ‡é¢˜åŒºåŸŸ */\n.title-section {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tmargin-bottom: 24rpx;\n}\n\n.title-tag {\n\tbackground: #2c2c2c;\n\tborder-radius: 999rpx;\n\tpadding: 12rpx 24rpx;\n}\n\n.title-text {\n\tcolor: #fff;\n\tfont-size: 32rpx;\n\tfont-weight: 700;\n}\n\n.read-count {\n\tcolor: #999;\n\tfont-size: 24rpx;\n}\n\n/* å†…å®¹å¡ç‰‡ */\n.content-card {\n\tfont-size: 28rpx;\n\tbackground: #fff;\n\tborder: 4rpx solid #2c2c2c;\n\tborder-radius: 24rpx;\n\tpadding: 24rpx;\n\tbox-shadow: 0 8rpx 0 #2c2c2c;\n\tmargin-bottom: 24rpx;\n\twidth: 100%;\n\tmax-width: 704rpx;\n}\n\n/* å¯Œæ–‡æœ¬å†…å®¹ */\n.rich-content {\n\tline-height: 1.8;\n}\n\n/* å›¾ç‰‡ç½‘æ ¼ */\n.image-grid {\n\tdisplay: grid;\n\tgrid-template-columns: repeat(3, 1fr);\n\tgap: 16rpx;\n\tmargin-top: 24rpx;\n}\n\n.content-image {\n\twidth: 100%;\n\theight: 200rpx;\n\tborder-radius: 12rpx;\n\tbackground: #f0f0f0;\n}\n</style>\n","import MiniProgramPage from 'E:/Uni-App-file/pet-house/pages/scienceDetail/scienceDetail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onMounted","uni","reactive","api","onLoad"],"mappings":"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"}