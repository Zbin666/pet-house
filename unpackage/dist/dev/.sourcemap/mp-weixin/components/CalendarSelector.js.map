{"version":3,"file":"CalendarSelector.js","sources":["components/CalendarSelector.vue","../../HBuilderX.4.57/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovVW5pLUFwcC1maWxlL3BldC1ob3VzZS9jb21wb25lbnRzL0NhbGVuZGFyU2VsZWN0b3IudnVl"],"sourcesContent":["<template>\n    <view class=\"cal card\">\n        <view class=\"cal-header\">\n            <text class=\"cal-nav\" @tap=\"changeMonth(-1)\">←</text>\n            <text class=\"cal-month\">{{ year }}年{{ month + 1 }}月</text>\n            <text class=\"cal-nav\" @tap=\"changeMonth(1)\">→</text>\n        </view>\n        <view class=\"cal-week\">\n            <text v-for=\"w in weeks\" :key=\"w\" class=\"w\">{{ w }}</text>\n        </view>\n        <view class=\"cal-grid\">\n            <view v-for=\"(d, i) in days\" :key=\"i\"\n                :class=\"['cell', d.inMonth ? 'in' : 'out', d.isToday ? 'today' : '', isSelected(d) ? 'selected' : '']\"\n                @tap=\"toggle(d)\">\n                <text class=\"num\">{{ d.day }}</text>\n                <image v-if=\"isSelected(d)\" class=\"sel-icon\" src=\"/static/record/isChoosed.png\" mode=\"widthFix\" />\n            </view>\n        </view>\n        <!-- actions removed; handled by parent modal -->\n    </view>\n</template>\n\n<script setup>\nimport { computed, ref, watch } from 'vue'\n\nconst props = defineProps({\n    modelValue: { type: Array, default: () => [] },\n    start: { type: String, default: '2020-01-01' },\n    end: { type: String, default: '2035-12-31' },\n    multiple: { type: Boolean, default: true }\n})\nconst emit = defineEmits(['update:modelValue', 'save'])\n\nconst today = new Date()\nconst current = ref(new Date(today.getFullYear(), today.getMonth(), 1))\nconst year = computed(() => current.value.getFullYear())\nconst month = computed(() => current.value.getMonth())\n\nconst weeks = ref(['一', '二', '三', '四', '五', '六', '日'])\n\nconst internal = ref(new Set(props.modelValue))\nwatch(() => props.modelValue, (val) => {\n    internal.value = new Set(val || [])\n})\n\nconst days = computed(() => {\n    const y = year.value, m = month.value\n    const first = new Date(y, m, 1)\n    const startWeek = (first.getDay() + 6) % 7\n    const daysInMonth = new Date(y, m + 1, 0).getDate()\n    const daysPrevMonth = new Date(y, m, 0).getDate()\n    const res = []\n    for (let i = 0; i < 42; i++) {\n        let day, inMonth\n        if (i < startWeek) { day = daysPrevMonth - startWeek + i + 1; inMonth = false }\n        else if (i < startWeek + daysInMonth) { day = i - startWeek + 1; inMonth = true }\n        else { day = i - startWeek - daysInMonth + 1; inMonth = false }\n        const isToday = inMonth && day === today.getDate() && m === today.getMonth() && y === today.getFullYear()\n        res.push({ y, m, day, inMonth, isToday })\n    }\n    return res\n})\n\nfunction pad(n) { return String(n).padStart(2, '0') }\nfunction keyFrom(d) { return `${d.y}-${pad(d.m + 1)}-${pad(d.day)}` }\n\nfunction isSelected(d) { return d.inMonth && internal.value.has(keyFrom(d)) }\n\nfunction toggle(d) {\n    if (!d.inMonth) return\n    const key = keyFrom(d)\n    if (props.multiple) {\n        if (internal.value.has(key)) internal.value.delete(key)\n        else internal.value.add(key)\n    } else {\n        internal.value = new Set([key])\n    }\n    emit('update:modelValue', Array.from(internal.value))\n}\n\nfunction changeMonth(delta) {\n    const y = current.value.getFullYear()\n    const m = current.value.getMonth() + delta\n    current.value = new Date(y, m, 1)\n}\n\n// save removed; parent controls\n</script>\n\n<style scoped>\n.card {\n    background: #fff;\n    border-radius: 24rpx;\n    border: 4rpx solid #2c2c2c;\n    padding: 16rpx;\n}\n\n.cal-header {\n    font-size: 34rpx;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 16rpx;\n}\n\n.cal-nav {\n    color: #555;\n    font-weight: 700;\n    padding: 0 8rpx;\n}\n\n.cal-month {\n    font-weight: 700;\n}\n\n.cal-week {\n    display: grid;\n    grid-template-columns: repeat(7, 1fr);\n    text-align: center;\n    color: #b0b0b0;\n    margin-bottom: 8rpx;\n}\n\n.w {\n    padding: 8rpx 0;\n}\n\n.cal-grid {\n    display: grid;\n    grid-template-columns: repeat(7, 1fr);\n    grid-auto-rows: 88rpx;\n    gap: 6rpx;\n}\n\n.cell {\n    position: relative;\n    background: #fff;\n    border-radius: 12rpx;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.cell.out {\n    background: #fff;\n    color: #bbb;\n    opacity: .6;\n}\n\n.cell.today .num {\n    font-weight: 700;\n}\n\n.cell.selected {\n    background: transparent;\n    color: #1a1a1a;\n    border: 4rpx solid #ffe68c;\n    border-radius: 18rpx;\n}\n\n.num {\n    font-size: 28rpx;\n    color: inherit;\n}\n\n/* selected icon */\n.sel-icon {\n    position: absolute;\n    top: 0rpx;\n    width: 92rpx;\n    height: 92rpx;\n    z-index: 2;\n}\n\n.cell.selected .num {\n    opacity: 0;\n}\n\n</style>\n","import Component from 'E:/Uni-App-file/pet-house/components/CalendarSelector.vue'\nwx.createComponent(Component)"],"names":["ref","computed","watch"],"mappings":";;;;;;;;;;;;;AAyBA,UAAM,QAAQ;AAMd,UAAM,OAAO;AAEb,UAAM,QAAQ,oBAAI,KAAM;AACxB,UAAM,UAAUA,cAAAA,IAAI,IAAI,KAAK,MAAM,YAAa,GAAE,MAAM,YAAY,CAAC,CAAC;AACtE,UAAM,OAAOC,cAAAA,SAAS,MAAM,QAAQ,MAAM,YAAW,CAAE;AACvD,UAAM,QAAQA,cAAAA,SAAS,MAAM,QAAQ,MAAM,SAAQ,CAAE;AAErD,UAAM,QAAQD,cAAAA,IAAI,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,GAAG,CAAC;AAErD,UAAM,WAAWA,cAAAA,IAAI,IAAI,IAAI,MAAM,UAAU,CAAC;AAC9CE,kBAAK,MAAC,MAAM,MAAM,YAAY,CAAC,QAAQ;AACnC,eAAS,QAAQ,IAAI,IAAI,OAAO,CAAA,CAAE;AAAA,IACtC,CAAC;AAED,UAAM,OAAOD,cAAQ,SAAC,MAAM;AACxB,YAAM,IAAI,KAAK,OAAO,IAAI,MAAM;AAChC,YAAM,QAAQ,IAAI,KAAK,GAAG,GAAG,CAAC;AAC9B,YAAM,aAAa,MAAM,OAAQ,IAAG,KAAK;AACzC,YAAM,cAAc,IAAI,KAAK,GAAG,IAAI,GAAG,CAAC,EAAE,QAAS;AACnD,YAAM,gBAAgB,IAAI,KAAK,GAAG,GAAG,CAAC,EAAE,QAAS;AACjD,YAAM,MAAM,CAAE;AACd,eAAS,IAAI,GAAG,IAAI,IAAI,KAAK;AACzB,YAAI,KAAK;AACT,YAAI,IAAI,WAAW;AAAE,gBAAM,gBAAgB,YAAY,IAAI;AAAG,oBAAU;AAAA,QAAO,WACtE,IAAI,YAAY,aAAa;AAAE,gBAAM,IAAI,YAAY;AAAG,oBAAU;AAAA,QAAM,OAC5E;AAAE,gBAAM,IAAI,YAAY,cAAc;AAAG,oBAAU;AAAA,QAAO;AAC/D,cAAM,UAAU,WAAW,QAAQ,MAAM,QAAS,KAAI,MAAM,MAAM,SAAU,KAAI,MAAM,MAAM,YAAa;AACzG,YAAI,KAAK,EAAE,GAAG,GAAG,KAAK,SAAS,SAAS;AAAA,MAC3C;AACD,aAAO;AAAA,IACX,CAAC;AAED,aAAS,IAAI,GAAG;AAAE,aAAO,OAAO,CAAC,EAAE,SAAS,GAAG,GAAG;AAAA,IAAG;AACrD,aAAS,QAAQ,GAAG;AAAE,aAAO,GAAG,EAAE,CAAC,IAAI,IAAI,EAAE,IAAI,CAAC,CAAC,IAAI,IAAI,EAAE,GAAG,CAAC;AAAA,IAAI;AAErE,aAAS,WAAW,GAAG;AAAE,aAAO,EAAE,WAAW,SAAS,MAAM,IAAI,QAAQ,CAAC,CAAC;AAAA,IAAG;AAE7E,aAAS,OAAO,GAAG;AACf,UAAI,CAAC,EAAE;AAAS;AAChB,YAAM,MAAM,QAAQ,CAAC;AACrB,UAAI,MAAM,UAAU;AAChB,YAAI,SAAS,MAAM,IAAI,GAAG;AAAG,mBAAS,MAAM,OAAO,GAAG;AAAA;AACjD,mBAAS,MAAM,IAAI,GAAG;AAAA,MACnC,OAAW;AACH,iBAAS,QAAQ,oBAAI,IAAI,CAAC,GAAG,CAAC;AAAA,MACjC;AACD,WAAK,qBAAqB,MAAM,KAAK,SAAS,KAAK,CAAC;AAAA,IACxD;AAEA,aAAS,YAAY,OAAO;AACxB,YAAM,IAAI,QAAQ,MAAM,YAAa;AACrC,YAAM,IAAI,QAAQ,MAAM,SAAU,IAAG;AACrC,cAAQ,QAAQ,IAAI,KAAK,GAAG,GAAG,CAAC;AAAA,IACpC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnFA,GAAG,gBAAgB,SAAS;"}