{"version":3,"file":"api.js","sources":["utils/api.js"],"sourcesContent":["// API 基础配置（真机调试使用本机 WLAN IP）\nconst BASE_URL = 'http://10.161.39.206:3000/api'\n\n// 请求拦截器\nconst request = (options) => {\n  return new Promise((resolve, reject) => {\n    // 获取token\n    const token = uni.getStorageSync('token')\n    \n    // 设置请求头\n    const header = {\n      'Content-Type': 'application/json'\n    }\n    \n    if (token) {\n      header['Authorization'] = `Bearer ${token}`\n    }\n    \n    uni.request({\n      url: BASE_URL + options.url,\n      method: options.method || 'GET',\n      data: options.data || {},\n      header,\n      success: (res) => {\n        if (res.statusCode >= 200 && res.statusCode < 300) {\n          resolve(res.data)\n        } else {\n          reject(res.data)\n        }\n      },\n      fail: (err) => {\n        reject(err)\n      }\n    })\n  })\n}\n\n// API 方法\nexport const api = {\n  // 用户认证\n  login: (data) => request({\n    url: '/auth/login',\n    method: 'POST',\n    data\n  }),\n  \n  getProfile: () => request({\n    url: '/auth/profile',\n    method: 'GET'\n  }),\n  \n  // 用户管理\n  updateProfile: (data) => request({\n    url: '/users/profile',\n    method: 'PUT',\n    data\n  }),\n  \n  getSettings: () => request({\n    url: '/users/settings',\n    method: 'GET'\n  }),\n  \n  updateSettings: (data) => request({\n    url: '/users/settings',\n    method: 'PUT',\n    data\n  }),\n  \n  uploadAvatar: (data) => request({\n    url: '/users/avatar',\n    method: 'POST',\n    data\n  }),\n  \n  getUserStats: () => request({\n    url: '/users/stats',\n    method: 'GET'\n  }),\n  \n  // 宠物管理\n  getPets: () => request({\n    url: '/pets',\n    method: 'GET'\n  }),\n  \n  getPet: (id) => request({\n    url: `/pets/${id}`,\n    method: 'GET'\n  }),\n  \n  createPet: (data) => request({\n    url: '/pets',\n    method: 'POST',\n    data\n  }),\n  \n  updatePet: (id, data) => request({\n    url: `/pets/${id}`,\n    method: 'PUT',\n    data\n  }),\n  \n  deletePet: (id) => request({\n    url: `/pets/${id}`,\n    method: 'DELETE'\n  }),\n  \n  // 记录管理\n  getRecords: (params) => request({\n    url: '/records',\n    method: 'GET',\n    data: params\n  }),\n  \n  getCalendar: (params) => request({\n    url: '/records/calendar',\n    method: 'GET',\n    data: params\n  }),\n  \n  getStats: (params) => request({\n    url: '/records/stats',\n    method: 'GET',\n    data: params\n  }),\n  \n  createRecord: (data) => request({\n    url: '/records',\n    method: 'POST',\n    data\n  }),\n  \n  updateRecord: (id, data) => request({\n    url: `/records/${id}`,\n    method: 'PUT',\n    data\n  }),\n  \n  deleteRecord: (id) => request({\n    url: `/records/${id}`,\n    method: 'DELETE'\n  }),\n  \n  // 提醒（订阅）管理\n  getSubscriptions: (params) => request({\n    url: '/subscriptions',\n    method: 'GET',\n    data: params\n  }),\n\n  createSubscription: (data) => request({\n    url: '/subscriptions',\n    method: 'POST',\n    data\n  }),\n\n  deleteSubscription: (id) => request({\n    url: `/subscriptions/${id}`,\n    method: 'DELETE'\n  }),\n\n  // 媒体管理\n  getUploadPolicy: (data) => request({\n    url: '/media/policy',\n    method: 'POST',\n    data\n  }),\n  \n  completeUpload: (data) => request({\n    url: '/media/complete',\n    method: 'POST',\n    data\n  }),\n  \n  // 社区功能\n  getFeeds: (params) => request({\n    url: '/feeds',\n    method: 'GET',\n    data: params\n  }),\n  \n  getFeed: (id) => request({\n    url: `/feeds/${id}`,\n    method: 'GET'\n  }),\n  \n  createFeed: (data) => request({\n    url: '/feeds',\n    method: 'POST',\n    data\n  }),\n  \n  likeFeed: (id) => request({\n    url: `/feeds/${id}/like`,\n    method: 'POST'\n  }),\n  \n  deleteFeed: (id) => request({\n    url: `/feeds/${id}`,\n    method: 'DELETE'\n  }),\n  \n  createComment: (id, data) => request({\n    url: `/feeds/${id}/comments`,\n    method: 'POST',\n    data\n  }),\n  \n  // 问答功能\n  getQuestions: (params) => request({\n    url: '/questions',\n    method: 'GET',\n    data: params\n  }),\n  \n  getQuestion: (id) => request({\n    url: `/questions/${id}`,\n    method: 'GET'\n  }),\n  \n  createQuestion: (data) => request({\n    url: '/questions',\n    method: 'POST',\n    data\n  }),\n  \n  deleteQuestion: (id) => request({\n    url: `/questions/${id}`,\n    method: 'DELETE'\n  }),\n  \n  createAnswer: (id, data) => request({\n    url: `/questions/${id}/answers`,\n    method: 'POST',\n    data\n  }),\n  \n  likeAnswer: (id) => request({\n    url: `/questions/answers/${id}/like`,\n    method: 'POST'\n  }),\n  \n  // 科普文章\n  getArticles: (params) => request({\n    url: '/articles',\n    method: 'GET',\n    data: params\n  }),\n  \n  getArticle: (id) => request({\n    url: `/articles/${id}`,\n    method: 'GET'\n  }),\n  \n  // 媒体管理\n  getUploadPolicy: (type) => request({\n    url: '/media/policy',\n    method: 'POST',\n    data: { type }\n  }),\n  \n  completeUpload: (data) => request({\n    url: '/media/complete',\n    method: 'POST',\n    data\n  }),\n  \n  createMedia: (data) => request({\n    url: '/media',\n    method: 'POST',\n    data\n  }),\n  \n  getMedia: (params) => request({\n    url: '/media',\n    method: 'GET',\n    data: params\n  }),\n  \n  deleteMedia: (id) => request({\n    url: `/media/${id}`,\n    method: 'DELETE'\n  }),\n\n  // 评论点赞\n  likeComment: (id) => request({\n    url: `/feeds/comments/${id}/like`,\n    method: 'POST'\n  }),\n\n  // 关注/取消关注问题\n  followQuestion: (id) => request({\n    url: `/questions/${id}/follow`,\n    method: 'POST'\n  }),\n\n  // 评论相关API\n  getComments: (questionId) => request({\n    url: `/questions/${questionId}/comments`,\n    method: 'GET'\n  }),\n\n  createComment: (questionId, data) => request({\n    url: `/questions/${questionId}/comments`,\n    method: 'POST',\n    data\n  }),\n\n  createReply: (commentId, data) => request({\n    url: `/questions/comments/${commentId}/replies`,\n    method: 'POST',\n    data\n  }),\n\n  likeComment: (commentId) => request({\n    url: `/questions/comments/${commentId}/like`,\n    method: 'POST'\n  }),\n\n  likeReply: (replyId) => request({\n    url: `/questions/replies/${replyId}/like`,\n    method: 'POST'\n  })\n}\n\nexport default api\n"],"names":["uni"],"mappings":"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"}